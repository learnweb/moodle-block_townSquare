define("block_townsquare/usersettings_save",["exports","core/ajax"],(function(_exports,_ajax){var obj;
/**
   * Javascript to save the user settings in the database.
   *
   * This file implements 1 functionality:
   * - If the "save settings" button is pressed, store the settings in the database.
   *
   * @module     block_townsquare/timefilter
   * @copyright  2024 Tamaro Walter
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=function(userid,settingsfromdb){settingsfromdb&&function(settingsfromdb){let futurebuttonid=converttimetoid(settingsfromdb.timefilterfuture,!0),pastbuttonid=converttimetoid(settingsfromdb.timefilterpast,!1);"ts_time_all"!==futurebuttonid?(futureradiobuttons.forEach((function(button){button.id===futurebuttonid&&(button.parentNode.classList.add("active"),button.checked=!0,button.dispatchEvent(new Event("change")),alltimebutton.forEach((function(alltimebutton){alltimebutton.checked=!1,alltimebutton.parentNode.classList.remove("active")})))})),pastradiobuttons.forEach((function(button){button.id===pastbuttonid&&(button.parentNode.classList.add("active"),button.checked=!0,button.dispatchEvent(new Event("change")),alltimebutton.forEach((function(alltimebutton){alltimebutton.checked=!1,alltimebutton.parentNode.classList.remove("active")})))}))):alltimebutton.forEach((function(button){button.parentNode.classList.add("active"),button.checked=!0,button.dispatchEvent(new Event("change"))}));checkboxes.forEach((function(checkbox){let basiclettercheck="basicletter"===checkbox.id&&""===settingsfromdb.basicletter,completionlettercheck="completionletter"===checkbox.id&&"0"===settingsfromdb.completionletter,postlettercheck="postletter"===checkbox.id&&"0"===settingsfromdb.postletter;(basiclettercheck||completionlettercheck||postlettercheck)&&checkbox.click()}))}(settingsfromdb);savebutton.addEventListener("click",(async function(){let timespans=function(){let settings={timepast:0,timefuture:0},settingsset=!1;if(alltimebutton.forEach((function(button){button.parentNode.classList.contains("active")&&(settings.timepast=convertidtotime(button.id),settings.timefuture=convertidtotime(button.id),settingsset=!0)})),settingsset)return settings;return futureradiobuttons.forEach((function(button){button.parentNode.classList.contains("active")&&(settings.timefuture=convertidtotime(button.id))})),pastradiobuttons.forEach((function(button){button.parentNode.classList.contains("active")&&(settings.timepast=convertidtotime(button.id))})),settings}(),letterfilter=function(){let settings={basicletter:0,completionletter:0,postletter:0};return checkboxes.forEach((function(checkbox){if(checkbox.checked)switch(checkbox.id){case"basicletter":settings.basicletter=1;break;case"completionletter":settings.completionletter=1;break;case"postletter":settings.postletter=1}})),settings}();await async function(userid,timefilterpast,timefilterfuture,basicletter,completionletter,postletter){let result;result=await _ajax.default.call([{methodname:"block_townsquare_record_usersettings",args:{userid:parseInt(userid),timefilterpast:timefilterpast,timefilterfuture:timefilterfuture,basicletter:basicletter,completionletter:completionletter,postletter:postletter,success:function(){console.log("Settings saved.")}}}]);let el=document.getElementById("ts_usersettings_successlabel");el.style.display="block",el.style.opacity=1,el.fadeOutTimer&&clearInterval(el.fadeOutTimer);return setTimeout((function(){el.fadeOutTimer=setInterval((function(){el.style.opacity>.4?el.style.opacity-=.1:el.style.opacity>0?el.style.opacity-=.2:(clearInterval(el.fadeOutTimer),el.style.display="none")}),100)}),3e3),result}(userid,timespans.timepast,timespans.timefuture,letterfilter.basicletter,letterfilter.completionletter,letterfilter.postletter)}))},_ajax=(obj=_ajax)&&obj.__esModule?obj:{default:obj};const savebutton=document.getElementById("ts_usersettings_savebutton"),alltimebutton=document.querySelectorAll(".ts_all_time_button"),futureradiobuttons=document.querySelectorAll(".ts_future_time_button"),pastradiobuttons=document.querySelectorAll(".ts_past_time_button"),checkboxes=document.querySelectorAll(".ts_letter_checkbox");function convertidtotime(id){switch(id){case"ts_time_all":return 15778463;case"ts_time_next_twodays":case"ts_time_last_twodays":return 172800;case"ts_time_next_fivedays":case"ts_time_last_fivedays":return 432e3;case"ts_time_next_week":case"ts_time_last_week":return 604800;case"ts_time_next_month":case"ts_time_last_month":return 2592e3}}function converttimetoid(time,future){switch(time){case"15778463":return"ts_time_all";case"172800":return future?"ts_time_next_twodays":"ts_time_past_twodays";case"432000":return future?"ts_time_next_fivedays":"ts_time_last_fivedays";case"604800":return future?"ts_time_next_week":"ts_time_last_week";case"2592000":return future?"ts_time_next_month":"ts_time_last_month"}}}));

//# sourceMappingURL=usersettings_save.min.js.map