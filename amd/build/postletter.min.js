define("block_townsquare/postletter",["exports","core/str","core/prefetch"],(function(_exports,_str,_prefetch){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=function(){contentElements.forEach((element=>{!async function(element){var message=element.innerHTML,firstPTag=message.indexOf("<p>"),lastPTag=message.lastIndexOf("</p>");message=(message=message.replace(/<p>&nbsp;<\/p>/g,"").replace(/&nbsp;/g,"")).substring(0,firstPTag+3)+message.substring(firstPTag+3,lastPTag).replace(/<p>/g,"<br>").replace(/<\/p>/g,"")+message.substring(lastPTag),element.innerHTML=message}(element),element.id,element.textContent.length>=250?(originalTexts[element.id]=element.textContent,cutString(element),element.parentElement.insertAdjacentHTML("beforeend","<p>"),buttons[element.id].setAttribute("showmore","true")):buttons[element.id].style.display="none"})),(0,_prefetch.prefetchStrings)("block_townsquare",["showmore","showless"]),addEventListener()};
/**
   * Javascript for the post letter
   *
   * @module     block_townsquare/postletter
   * @copyright  2023 Tamaro Walter
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
const contentElements=document.getElementsByClassName("postletter_message"),buttons=document.getElementsByClassName("townsquare_showmore"),originalTexts=[],Selectors_actions={seemorebutton:'[data-action="block_townsquare/showmore_button"]'};function cutString(element){let text=element.textContent,index=250;for(;" "!=text.charAt(index);)index++;element.textContent=text.substring(0,index)}const addEventListener=()=>{document.addEventListener("click",(e=>{if(e.target.closest(Selectors_actions.seemorebutton)){let letterid=e.target.id;contentElements.forEach((element=>{element.id==letterid&&("true"==buttons[letterid].getAttribute("showmore")?(element.textContent=originalTexts[letterid],changeButtonString(letterid,!1)):(cutString(element),changeButtonString(letterid,!0)))}))}}))};async function changeButtonString(index,toshowmore){1==toshowmore?(buttons[index].textContent=await(0,_str.getString)("showmore","block_townsquare"),buttons[index].setAttribute("showmore","true")):(buttons[index].textContent=await(0,_str.getString)("showless","block_townsquare"),buttons[index].setAttribute("showmore","false"))}}));

//# sourceMappingURL=postletter.min.js.map